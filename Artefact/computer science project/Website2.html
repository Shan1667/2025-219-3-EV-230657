<!DOCTYPE html>
<html lang="en">

<head>
    <title>Firebase Test Connection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <style>
        ul.a {
  list-style-type: upper-roman;
}
    </style>

</head>

<body>
    <h1>
        TV-Shows/Movies genre website
    </h1>
    <ul class="a">
        <li><a href="./survey.html">Visit survey form</a></li></li>
    </ul>

    </fieldset>
    <img src="netflix-background-9-900x506.jpg" alt="alternatetext" width="2000" height="1000">
    <p>
    This website is going to help you find out what types of genres are worth watching and which ones are not.
       
    Also This website will also help you out by finding what genre most people like or what genre has the best
        movies/Tv-Shows,
    the first graph will show the user which genre is the most popular by their score points in the movie section</p>
        <canvas id="myChart"></canvas>
        <fieldset>
            <label for="choosetv1">choose first genre:</label>
            <select name="choosetv1" id="choosetv1">
                <option value="action">Action</option>
                <option value="animation">Animation</option>
                <option value="comedy">Comedy</option>
                <option value="crime">Crime</option>
                <option value="documentary">Documentary</option>
                <option value="drama">drama</option>
                <option value="reality">reality</option>
                <option value="romance">Romance</option>
                <option value="scifi">SciFi</option>
                <option value="thriller">Thriller</option>
                <option value="war">War</option>
                <option value="western">Western</option>
            </select>
    
            <label for="choosetv2">choose second genre:</label>
            <select name="choosetv2" id="choosetv2">
                <option value="action">Action</option>
                <option value="animation">Animation</option>
                <option value="comedy">Comedy</option>
                <option value="crime">Crime</option>
                <option value="documentary">Documentary</option>
                <option value="drama">drama</option>
                <option value="reality">reality</option>
                <option value="romance">Romance</option>
                <option value="scifi">SciFi</option>
                <option value="thriller">Thriller</option>
                <option value="war">War</option>
                <option value="western">Western</option>
            </select>
    
            <label for="choosetv3">choose thrid genre:</label>
            <select name="choosetv3" id="choosetv3">
                <option value="action">Action</option>
                <option value="animation">Animation</option>
                <option value="comedy">Comedy</option>
                <option value="crime">Crime</option>
                <option value="documentary">Documentary</option>
                <option value="drama">drama</option>
                <option value="reality">reality</option>
                <option value="romance">Romance</option>
                <option value="scifi">SciFi</option>
                <option value="thriller">Thriller</option>
                <option value="war">War</option>
                <option value="western">Western</option>
            </select>
            
        <input type="button" id="choosetv" value="submit" name="submit">

        
        
    </h2>
    <p>also the graph is interactive so the user can change which genres he can look at and can then compare that genre
        to the other genres</p>
    
        </fieldset>
        <h2>This graph here can allow the user to enter a score and it will then show all of genres within that range</h2>
        <canvas id="myChart3"></canvas>
        <canvas id="myChart2"></canvas>
    <fieldset>
        <label for="quantity">Quantity (enter a number from 0-1129):</label>
        <input type="number" id="quantity" name="quantity" min="1" max="1129">
        <label for="quantity2">Quantity (enter a number from 0-1129):</label>
        <input type="number" id="quantity2" name="quantity2" min="1" max="1129">
        <input type="button" id="quantites" value="submit" name="submit">
        </fieldset>

    <h1>FAQ</h1>
    <h2>Which TV-Show was the most popular and which show was the least popular in this year?</h2>
    <h3>please select the year to see what genre was popular and which one was the least popular</h3>
    <h3>Also some years only one show or movie in it so if that happens you will be told that only 1 show came up in this year</h3>
    <fieldset>
        <select name="tvshowpoint" id="tvshowpoint2">
            <option value="2022">2022</option>
            <option value="2021">2021</option>
            <option value="2020">2020</option>
            <option value="2019">2019</option>
            <option value="2018">2018</option>
            <option value="2017">2017</option>
            <option value="2016">2016</option>
            <option value="2015">2015</option>
            <option value="2014">2014</option>
            <option value="2013">2013</option>
            <option value="2012">2012</option>
            <option value="2011">2011</option>
            <option value="2010">2010</option>
            <option value="2009">2009</option>
            <option value="2008">2008</option>
            <option value="2007">2007</option>
            <option value="2006">2006</option>
            <option value="2005">2005</option>
            <option value="2004">2004</option>
            <option value="2003">2003</option>
            <option value="2002">2002</option>
            <option value="2001">2001</option>
            <option value="2000">2000</option>
            <option value="1999">1999</option>
            <option value="1998">1998</option>
            <option value="1997">1997</option>
            <option value="1995">1995</option>
            <option value="1993">1993</option>
            <option value="1989">1989</option>
            <option value="1969">1969</option>
        </select>
    </fieldset>
    <p id="shows" style="color:blue"> </p>


    <h2>Which Movie was the most popular and which movie was the least popular in this year?</h2>
    <H3>This graph shows the user the the genres depending on how high their score is</H3>
    <fieldset>
        <select name="moviepoint" id="movieshowpoint2">
            <option value="2022">2022</option>
            <option value="2021">2021</option>
            <option value="2020">2020</option>
            <option value="2019">2019</option>
            <option value="2018">2018</option>
            <option value="2017">2017</option>
            <option value="2016">2016</option>
            <option value="2015">2015</option>
            <option value="2014">2014</option>
            <option value="2013">2013</option>
            <option value="2012">2012</option>
            <option value="2011">2011</option>
            <option value="2010">2010</option>
            <option value="2009">2009</option>
            <option value="2008">2008</option>
            <option value="2007">2007</option>
            <option value="2006">2006</option>
            <option value="2005">2005</option>
            <option value="2004">2004</option>
            <option value="2003">2003</option>
            <option value="2002">2002</option>
            <option value="2001">2001</option>
            <option value="2000">2000</option>
            <option value="1999">1999</option>
            <option value="1998">1998</option>
            <option value="1997">1997</option>
            <option value="1996">1996</option>
            <option value="1995">1995</option>
            <option value="1994">1994</option>
            <option value="1993">1993</option>
            <option value="1992">1992</option>
            <option value="1991">1991</option>
            <option value="1990">1990</option>
            <option value="1989">1989</option>
            <option value="1987">1986</option>
            <option value="1986">1986</option>
            <option value="1984">1984</option>
            <option value="1982">1982</option>
            <option value="1980">1980</option>
            <option value="1979">1979</option>
            <option value="1976">1976</option>
            <option value="1975">1975</option>
            <option value="1973">1973</option>
            <option value="1971">1971</option>
            <option value="1967">1967</option>
            <option value="1966">1966</option>
            <option value="1964">1964</option>
            <option value="1961">1961</option>
            <option value="1954">1954</option>
        </select>
    </fieldset>
    <p id="movies" style="color:blue"> </p>



    </fieldset>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC_2F2GrlWDBU_5GhOzMZLCxYg_-qgTsyA",
            authDomain: "lc-project-2025-2269a.firebaseapp.com",
            databaseURL: "https://lc-project-2025-2269a-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "lc-project-2025-2269a",
            storageBucket: "lc-project-2025-2269a.firebasestorage.app",
            messagingSenderId: "1077764091378",
            appId: "1:1077764091378:web:e5d87cdfccaf7e2e774f6b"
        };
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        import { getDatabase, ref, set, get, update, child } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";
        const database = getDatabase(); //This creates a firebase instance
        // let link_to_database_root = ref(database); //This creates a reference (link) to the root of your database
        //This will create a reference to whatever address comes after the comma
        const firebaseRef = ref(database);
        let movieData = {}
        let showData = {}
        function processing(snapshot) {
            console.log('Processing function')
            // console.log(snapshot.size)//number of children in the snapshot
            // snapshot.forEach(function () { console.log('Key =>', snapshot.key); console.log('Value =>', snapshot.val()); })
            console.log(snapshot.val())
            //snapshot.forEach(processing2);
        }

        get(child(firebaseRef, "/Data_for_movie_graph/")).then(
            (snapshot) => {
                movieData = snapshot.val()
                create_responsive_graphs2(Object.keys(movieData), Object.values(movieData))

            });

        function create_responsive_graphs2(x, y) {
            const xValues = x;//[50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150];
            const yValues = y;//[7, 8, 8, 9, 9, 9, 10, 11, 14, 14, 15];
            console.log('input',x,y)

            secondGraph = new Chart("myChart2", {

                type: "line",
                data: {
                    labels: xValues,
                    datasets: [{


                        data: yValues,
                        backgroundColor: ['red', "orange", "yellow", "pink", "purple", "cyan", "blue", "lime", "green", "brown", "crimson", "grey", "violet", "light"]
                    }]
                },
                options: {
                    legend: {
                        display: false
                    },

                    title: { display: true, text: 'Movies genre' },
                    responsive: true,
                maintainAspectRatio: true,
                    scales: {
                        yAxes: [{
                            ticks: { beginAtZero: true }, scaleLabel: {
                                display: true,
                                labelString: 'Score'
                            }
                        }], xAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Genre'
                            }
                        }],
                    }




                }
            });

        }
        let firstGraph = null;
        let secondGraph = null;
        get(child(firebaseRef, "/Data_for_show_graph/")).then(
            (snapshot) => {
                showData = snapshot.val()
                create_responsive_graphs(Object.keys(showData), Object.values(showData))

            });

        function create_responsive_graphs(x, y) {
            //         const xValues = x;//[50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150];
            // const yValues = y;//[7, 8, 8, 9, 9, 9, 10, 11, 14, 14, 15];


            firstGraph = new Chart("myChart", {
                type: "bar",
                data: {
                    labels: x,
                    datasets: [{


                        data: y,
                        backgroundColor: ['red', "orange", "yellow", "pink", "purple", "cyan", "blue", "lime", "green", "brown", "black", "grey"]
                    }]
                },
                options: {
                    legend: {
                        display: false
                    },

                    title: { display: true, text: 'Tv-Show genre' },
                    scales: {
                        yAxes: [{
                            ticks: { beginAtZero: true }, scaleLabel: {
                                display: true,
                                labelString: 'Score '
                            }
                        }], xAxes: [{
                            scaleLabel: {
                                display: true,
                                labelString: 'Genre'
                            }
                        }],
                    }




                }


            });




        }


        // update(ref(database, 'posts/' + 'newerpost2'), {
        // username: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 100],
        // email: 'otheremail'
        // });
        let surveyResults = document.getElementById("tvshowpoint2")
        surveyResults.addEventListener('change', surveyView)
        function surveyView(event) {
            alert('function called')
            get(child(firebaseRef, "/Best_and_worst_genres_for_Tv_Shows/")).then(
                (snapshot) => {
                    let results = snapshot.val()[surveyResults.value]
                    if (results['Best_title'] === results['Worst_title']) {
                        document.getElementById('shows').innerHTML = `There was only one show for this year`
                    }
                    else {
                        document.getElementById('shows').innerHTML = `The most popular show this year was "${results['Best_title']}" with a user score of ${results['Best_number_of_votes']} and the least popular show from this year was "${results["Worst_title"]}" with a user score of ${results["Worst_number_of_votes"]}`
                    }
                    console.log('here are the results', snapshot.val()[surveyResults.value])
                    //    movieDataTV = Object.values(snapshot.val())
                    //    console.log('This is the moviedata', movieDataTV)
                })
        }

        let surveyResults2 = document.getElementById("movieshowpoint2")
        surveyResults2.addEventListener('change', surveyViewmovies)
        function surveyViewmovies(event) {
            alert('function called')
            get(child(firebaseRef, "/Best_and_worst_genres_for_movies/")).then(
                (snapshot) => {
                    let results = snapshot.val()[surveyResults2.value]
                    if (results['Best_title'] === results['Worst_title']) {
                        document.getElementById('movies').innerHTML = `There was only one Movie for this year`
                    }
                    else {
                        document.getElementById('movies').innerHTML = `The most popular Movie this year was "${results['Best_title']}"" with a user score of ${results['Best_number_of_votes']} and the least popular movie from this year was "${results['Worst_title']}" with a user score of ${results['Worst_number_of_votes']}`
                    }
                    console.log('here are the results', snapshot.val()[surveyResults2.value])
                    //    movieDataTV = Object.values(snapshot.val())
                    //    console.log('This is the moviedata', movieDataTV)
                })
        }

        // Code to control responsive graph 1
        let TvShowselect = document.getElementById('choosetv1')

        let TvShowselect2 = document.getElementById('choosetv2')
        let Tvshowselect3 = document.getElementById('choosetv3')
        let TvShowsubmit = document.getElementById('choosetv')
        TvShowsubmit.addEventListener('click', tvshowfilter)

        function tvshowfilter(event) {

            alert('calling submit')
            event.preventDefault()
            if (firstGraph) {
                firstGraph.destroy()
            }
            get(child(firebaseRef, "/Data_for_show_graph/")).then(
                (snapshot) => {
                    let showData1 = snapshot.val()[TvShowselect.value]
                    let showData2 = snapshot.val()[TvShowselect2.value]
                    let showData3 = snapshot.val()[Tvshowselect3.value]

                    if (TvShowselect.value === TvShowselect2.value) {
                        create_responsive_graphs([TvShowselect.value], [showData1])
                    }
                    else {

                        create_responsive_graphs([TvShowselect.value, TvShowselect2.value, Tvshowselect3.value], [showData1, showData2, showData3])
                    }
                });
        }


        // Code to control responsive graph 2
        let MvShowselect = document.getElementById('quantity')

        let MvShowselect2 = document.getElementById('quantity2')
        let MvShowsubmit = document.getElementById('quantites')
        MvShowsubmit.addEventListener('click', Mvshowfilter)
        // let TvShowselect = document.getElementById('choosetv1')
        // let TvShowselect2 = document.getElementById('choosetv2')
        // let TvShowsubmit = document.getElementById('choosetv')
        // TvShowsubmit.addEventListener('click', tvshowfilter)

        function Mvshowfilter(event) {

            alert('calling submit')
            event.preventDefault()
            if (secondGraph) {
                secondGraph.destroy()
            }
            get(child(firebaseRef, "/Data_for_movie_graph/")).then(
                (snapshot) => {
                    let allDataValues = Object.values(snapshot.val())
                    let allDataLabels = Object.keys(snapshot.val())

                    let minimumvalue = MvShowselect.value
                    let maximumvalue = MvShowselect2.value
                    console.log(maximumvalue)
                    console.log(minimumvalue)
                    // let valueforgrpahing = {"action":0, "animation":0, "comedy":0, "crime":0, "documentary":0, "drama":0, "fantasy": 0, "horror":0, "musical":0, "sports":0, "reality":0, "romance":0, "scifi":0, "thriller":0, "war":0, "western":0}
                    let valueforgrpahing ={}
                    for (let [genre,value] of Object.entries(snapshot.val()))
                    {
                        // console.log('genre is: ', genre , ' value is: ',value)
                         if (value > minimumvalue && value < maximumvalue ) {
                             console.log(genre,value)

                            valueforgrpahing[genre]=value
                         }

                    }
                    console.log(valueforgrpahing)
                    create_responsive_graphs2(Object.keys(valueforgrpahing), Object.values(valueforgrpahing))
                    // for (let i of allDataValues) {
                    //     if (i > minimumvalue && i < maximumvalue) {
                    //         valueforgrpahing.push(i)

                    //     }



                    // }
                    // console.log(valueforgrpahing)
                    // let showData1 = snapshot.val()[TvShowselect.value]
                    // let showData2 = snapshot.val()[TvShowselect2.value]

                    // if (TvShowselect.value === TvShowselect2.value) {
                    //     create_responsive_graphs([TvShowselect.value], [showData1])
                    // }
                    // else {

                    // create_responsive_graphs2([], valueforgrpahing)
                     }
                );
                    }
        

    </script>
</body>

</html>